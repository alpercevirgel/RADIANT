stat_summary(aes(y=entropy_cor_T0T5num_med, x=sex),size=0.2,
position = position_nudge(-0.23))+
theme(legend.position = "none")+
ylab("Immune entropy (1-r)")
df_plot <- entropy_scores_plot %>%
drop_na(MIA_CMV_Seropositivity) %>%
droplevels()
n3<-ggplot(df_plot)+
geom_point(
aes(x = `CMV Seropositivity`,y = entropy_cor_T0T5num_med, group = `CMV Seropositivity`, color=`CMV Seropositivity`),
position = position_jitter(width = 0.1,seed =42),
size = 1.5,
alpha = .2,
show.legend = FALSE
)+
geom_half_violin(
aes(x = `CMV Seropositivity`,y = entropy_cor_T0T5num_med, group = `CMV Seropositivity`, fill=`CMV Seropositivity`),
alpha = .5,
side = "r",
position = position_nudge(0.13),
)+
geom_half_boxplot(
aes(x = `CMV Seropositivity`,y = entropy_cor_T0T5num_med, group = `CMV Seropositivity`, fill=`CMV Seropositivity`),
alpha = .5,
side = "l",
outlier.shape = NA,
center = FALSE,
errorbar.draw = FALSE,
width = .4,
position = position_nudge(-0.13),
)+
theme_classic()+
scale_fill_manual(values=c("#D55E00","#56B4E9"))+
scale_color_manual(values=c("#D55E00","#56B4E9"))+
stat_summary(aes(y=entropy_cor_T0T5num_med, x=`CMV Seropositivity`),size=0.2,
position = position_nudge(-0.23))+
theme(legend.position = "none")+
ylab("Immune entropy (1-r)")
df_plot <- entropy_scores_plot %>%
drop_na(cluster_number)
n4 <- ggplot(df_plot, aes(x=cluster_number, y=entropy_cor_T0T5num_med)) +
geom_boxplot(aes(fill=cluster_number), alpha=0.9,outlier.size=0,outlier.colour="white") +
geom_jitter(aes(fill=cluster_number), alpha=0.4, width = 0.3, shape=21,size=1) +
scale_fill_manual("Immunotypes", values=cols_cluster) +
theme_classic()+xlab("Immunotypes")+
stat_summary(aes(y=entropy_cor_T0T5num_med, x=cluster_number),size=0.2)+
theme(legend.position = "none")+
ylab("Immune entropy (1-r)")
wilcox.test(entropy_scores_plot$entropy_cor_T0T5num_med ~ entropy_scores_plot$sex)
wilcox.test(entropy_scores_plot$entropy_cor_T0T5num_med ~ entropy_scores_plot$`CMV Seropositivity`)
n5 <- ggplot(entropy_scores_plot)+
geom_point(
aes(x = ResponseGroup_Triple,y = entropy_cor_T0T5num_med, group = ResponseGroup_Triple, color=ResponseGroup_Triple),
position = position_jitter(width = 0.1,seed =42),
size = 1.5,
alpha = .2,
show.legend = FALSE
)+
geom_half_violin(
aes(x = ResponseGroup_Triple,y = entropy_cor_T0T5num_med, group = ResponseGroup_Triple, fill=ResponseGroup_Triple),
alpha = .5,
side = "r",
position = position_nudge(0.13),
)+
geom_half_boxplot(
aes(x = ResponseGroup_Triple,y = entropy_cor_T0T5num_med, group = ResponseGroup_Triple, fill=ResponseGroup_Triple),
alpha = .5,
side = "l",
outlier.shape = NA,
center = FALSE,
errorbar.draw = FALSE,
width = .4,
position = position_nudge(-0.13),
)+
theme_classic()+
stat_summary(aes(y=entropy_cor_T0T5num_med, x=ResponseGroup_Triple),size=0.2,
position = position_nudge(-0.23))+
theme(legend.position = "none")+
scale_fill_manual(values=c("brown1","darkgoldenrod1","deepskyblue2","blue"))+
scale_color_manual(values=c("brown1","darkgoldenrod1","deepskyblue2","blue"))+
ylab("Immune entropy (1-r)")+
xlab("Triple vaccine response group")
n1
n2
n3
n4
n5
entropy_scores_plot %>%
filter(ResponseGroup_Triple %in% "1") %>%
select(entropy_cor_T0T5num_med) %>%
summary()
df_stat <- entropy_scores_plot %>%
select(cluster_number,entropy_cor_T0T5num_med) %>%
drop_na(cluster_number)
## melt
df_stat_melt <- df_stat %>%
reshape2::melt(.)
### kruskal.test and Dunn's test
## With kruskal.test we identify overall which subsets are significant and then Dunn's test tells us which are different between pairs of clusters
kw.test.all <- df_stat_melt %>%
group_by(variable) %>%
kruskal_test(value ~ cluster_number) %>%
adjust_pvalue(method = "BH")
kw.test.all.eff.size <- df_stat_melt %>%
group_by(variable) %>%
kruskal_effsize(value ~ cluster_number)
combine.kw <- kw.test.all %>%
left_join(kw.test.all.eff.size, by="variable") %>%
filter(p.adj < 0.05)
## Number of variables with p.adj-value <0.05
length(combine.kw$variable)
## table summarizing effect size of the significant variables
table(combine.kw$magnitude)
### Post-hoc analysis dunn's test, pairwise multiple comparisons to check which are significant in pairwise analysis.
dunn_entropy_immunotype <- df_stat_melt %>%
group_by(variable) %>%
dunn_test(value ~ cluster_number, p.adjust.method = "BH", detailed = TRUE)%>%
filter(p.adj.signif != "ns")
df_stat <- entropy_scores_plot %>%
select(ResponseGroup_Triple,entropy_cor_T0T5num_med) %>%
drop_na(ResponseGroup_Triple,entropy_cor_T0T5num_med)
## melt
df_stat_melt <- df_stat %>%
reshape2::melt(.)
### kruskal.test and Dunn's test
## With kruskal.test we identify overall which subsets are significant and then Dunn's test tells us which are different between pairs of clusters
kw.test.all <- df_stat_melt %>%
group_by(variable) %>%
kruskal_test(value ~ ResponseGroup_Triple) %>%
adjust_pvalue(method = "BH")
kw.test.all.eff.size <- df_stat_melt %>%
group_by(variable) %>%
kruskal_effsize(value ~ ResponseGroup_Triple)
combine.kw <- kw.test.all %>%
left_join(kw.test.all.eff.size, by="variable") %>%
filter(p.adj < 0.05)
## Number of variables with p.adj-value <0.05
length(combine.kw$variable)
## table summarizing effect size of the significant variables
table(combine.kw$magnitude)
### Post-hoc analysis dunn's test, pairwise multiple comparisons to check which are significant in pairwise analysis.
dunn_entropy_triplevaccineresponse <- df_stat_melt %>%
group_by(variable) %>%
dunn_test(value ~ ResponseGroup_Triple, p.adjust.method = "BH", detailed = TRUE)%>%
filter(p.adj.signif != "ns")
dunn_entropy_triplevaccineresponse
model_cimm <-trivac_imm %>%
left_join(entropy_scores) %>%
drop_na(cluster_number,ResponseGroup_Triple) %>%
rename(`Immunotype `=cluster_number)%>%
rename(Age=age)%>%
rename(`Immune entropy`=entropy_cor_T0T5num_med)%>%
rename(Sex=sex)%>%
rename(CMV=MIA_CMV_Seropositivity)%>%
filter(CMV %!in% 3) %>%
mutate(quartile_influ_d0_immR = recode(quartile_influ_d0_immR,
"5" = "Q1",
"[10, 28)" = "Q2",
"[28, 57)" = "Q3",
"[57,320]" = "Q4")) %>%
mutate(Sex = recode(Sex,
"1" = ": male",
"2" = ": female")) %>%
mutate(CMV = recode(CMV,
"1" = ": positive",
"2" = ": negative")) %>%
droplevels()
model_cimm$Sex <- factor(model_cimm$Sex, levels = c(": female",": male"))
model_cimm$CMV <- factor(model_cimm$CMV, levels = c(": negative",": positive"))
# contrasts(model_cimm$`day 0 HI`) = contr.sum(4)
contrasts(model_cimm$`Immunotype `) = contr.sum(9)
contrasts(model_cimm$quartile_influ_d0_immR) = contr.sum(4)
model_cimm$`Immune entropy`<-log10(model_cimm$`Immune entropy`)
logit_model <- clm(ResponseGroup_Triple ~ `Immune entropy`+Sex+Age+CMV + quartile_influ_d0_immR, data = model_cimm)
summary(logit_model)
logit_model_preds <- tidy(logit_model, conf.int = TRUE, exponentiate = TRUE) %>%
select(term,estimate, p.value, conf.low,conf.high) %>%
mutate(
estimate = round(estimate, 10),
conf.low = round(conf.low, 2),
conf.high = round(conf.high, 2)
) %>%
filter(term %!in% c("1|2","2|3","3|4"))
##### day 0 HI #####
# Coefficients and variance for groups HI 1...4
b <- coef(logit_model)
ix <- startsWith(names(b), "quartile_influ_d0_immR")
b1.3 <- b[ix]
b1.3.var <- diag(vcov(logit_model)[ix,ix])
# Coefficients and variance for group 4
b.lincomb <- matrix(rep(-1,sum(ix)),nrow=1)
b4 <- b.lincomb %*% b1.3
b4.var <- b.lincomb %*% vcov(logit_model)[ix,ix] %*% t(b.lincomb)
# Combine
params <- c(b1.3, quartile_influ_d0_immR4=b4)
params.sd <- sqrt(c(b1.3.var, quartile_influ_d0_immR4=b4.var))
Q4_estimate <- b4
Q4_se <- b4.var^0.5
t_value <- Q4_estimate / Q4_se
p_value <- 2 * pt(-abs(t_value), df.residual(logit_model))
HIQ4_df <- data.frame(term = "quartile_influ_d0_immR4",
estimate = exp(Q4_estimate),   # Exponentiate the estimate
p.value = p_value,
conf.low = exp(Q4_estimate - 1.96 * Q4_se),  # Exponentiate the lower bound of the CI
conf.high = exp(Q4_estimate + 1.96 * Q4_se) # Exponentiate the upper bound of the CI
)
logit_plot <- rbind(logit_model_preds, HIQ4_df) %>%
mutate(term = case_when(
grepl("quartile_influ_d0_immR", term) ~ gsub("quartile_influ_d0_immR", "Day 0 HI Q", term),
TRUE ~ term
))
logit_plot<- logit_plot %>%
arrange(desc(estimate))
m1 <- ggplot(logit_plot, aes(y = estimate, x = term)) +
geom_pointrange(aes(ymin = conf.low, ymax = conf.high),
size = 0.5) +
geom_hline(yintercept = 1.0, linetype = "dotted", size = 1) +
scale_y_log10() +
labs(y = "Odds ratio", x = "") +
coord_flip() +
theme_classic()+
theme(legend.position = "none")
m1
ggsave(file = paste0(models.dir, "entropy_trivac.pdf", sep=""), width =4 , height =3)
logit_model <- clm(ResponseGroup_Triple ~ Sex+Age+CMV + quartile_influ_d0_immR, data = model_cimm)
summary(logit_model)
model <- lm(`Immune entropy` ~ Age + Sex + CMV , data = model_cimm)
summary(model)
ggarrange(n1,n5,n4,m1)
ggsave(file = paste0(models.dir, "Fig2.pdf", sep=""), width =8 , height =6)
beckman_coulter_d0 %>%
filter(subject_identifier %in% IDs_trivac_entropy_woCMV3)
## for only resp groups and immunotypes
IDs_trivac_entropy_woCMV3 <- trivac_resp_quartiles %>%
left_join(immunotype) %>%
left_join(chronic_viral_inf) %>%
drop_na(ResponseGroup_Triple,cluster_number) %>%
filter(MIA_CMV_Seropositivity %!in% 3) %>%
select(subject_identifier) %>%
pull()
entropy_scores_DxH <- truc_influ_d0 %>%
drop_na() %>%
filter(subject_identifier %in% IDs_trivac_entropy_woCMV3) %>%
select(subject_identifier)
# immune_cols are the variables I want to use in the analysis
immune_cols <- beckman_coulter_d0 %>%
filter(subject_identifier %in% IDs_trivac_entropy_woCMV3) %>%
dplyr::select(`WBC`,`RBC`,`HGB`,`HCT`,`MCV`,`MCH`,`MCHC`,`RDW`,`RDWSD`,`PLT`,`MPV`,`LY_per`,`MO_per`,`NE_per`,`EO_per`,`BA_per`,`LY_num`,`MO_num`,`NE_num`, `EO_num`,`BA_num`)%>%
colnames()
# per iteration calculating ref groups
# First, calculate the median for each immune parameter in the reference group
reference_median <- beckman_coulter_d0 %>%
filter(subject_identifier %in% IDs_trivac_entropy_woCMV3) %>%
left_join(vital_subject)%>%
filter(age<35) %>%
summarise(across(all_of(immune_cols), median))
# Transpose this single-row dataframe to a named vector
reference_vector <- t(reference_median)
# Then, calculate the correlation-based distance for each individual
entropy_scores_DxH$entropy_cor_T0T5num_med <- beckman_coulter_d0 %>%
filter(subject_identifier %in% IDs_trivac_entropy_woCMV3) %>%
rowwise() %>%
mutate(distance = 1 - cor(c_across(all_of(immune_cols)), reference_vector, method = "spearman")) %>%
ungroup() %>%
pull(distance)
entropy_scores_plot <- trivac_imm %>%
left_join(entropy_scores_DxH) %>%
drop_na(cluster_number,entropy_cor_T0T5num_med,ResponseGroup_Triple)%>%
droplevels() %>%
mutate(sex = recode(sex, "1" = "Male", "2" = "Female"),
`CMV Seropositivity` = recode(MIA_CMV_Seropositivity, "1" = "+", "2" = "-"))%>%
mutate(sex = factor(sex, levels = c("Female", "Male")),
`CMV Seropositivity` = factor(`CMV Seropositivity`, levels = c("-", "+")))
n1 <- ggscatter(entropy_scores_plot,
x = "age",
y = "entropy_cor_T0T5num_med",
alpha = 0.1,
add = "reg.line",  # Add regression line
conf.int = TRUE)+ # Add confidence interval
stat_cor(show.legend = FALSE,
method = "spearman",
p.accuracy = 0.001,
r.accuracy = 0.01)+
xlab("Age (years)")+
ylab("Immune entropy (1-r)")
library(gghalves)
wilcox.test(entropy_scores_plot$entropy_cor_T0T5num_med ~ entropy_scores_plot$sex)
n2<- ggplot(entropy_scores_plot)+
geom_point(
aes(x = sex,y = entropy_cor_T0T5num_med, group = sex, color=sex),
position = position_jitter(width = 0.1,seed =42),
size = 1.5,
alpha = .2,
show.legend = FALSE
)+
geom_half_violin(
aes(x = sex,y = entropy_cor_T0T5num_med, group = sex, fill=sex),
alpha = .5,
side = "r",
position = position_nudge(0.13),
)+
geom_half_boxplot(
aes(x = sex,y = entropy_cor_T0T5num_med, group = sex, fill=sex),
alpha = .5,
side = "l",
outlier.shape = NA,
center = FALSE,
errorbar.draw = FALSE,
width = .4,
position = position_nudge(-0.13),
)+
scale_fill_manual(values=c("#009E73","#E69F00"))+
scale_color_manual(values=c("#009E73","#E69F00"))+
theme_classic()+
stat_summary(aes(y=entropy_cor_T0T5num_med, x=sex),size=0.2,
position = position_nudge(-0.23))+
theme(legend.position = "none")+
ylab("Immune entropy (1-r)")
df_plot <- entropy_scores_plot %>%
drop_na(MIA_CMV_Seropositivity) %>%
droplevels()
n3<-ggplot(df_plot)+
geom_point(
aes(x = `CMV Seropositivity`,y = entropy_cor_T0T5num_med, group = `CMV Seropositivity`, color=`CMV Seropositivity`),
position = position_jitter(width = 0.1,seed =42),
size = 1.5,
alpha = .2,
show.legend = FALSE
)+
geom_half_violin(
aes(x = `CMV Seropositivity`,y = entropy_cor_T0T5num_med, group = `CMV Seropositivity`, fill=`CMV Seropositivity`),
alpha = .5,
side = "r",
position = position_nudge(0.13),
)+
geom_half_boxplot(
aes(x = `CMV Seropositivity`,y = entropy_cor_T0T5num_med, group = `CMV Seropositivity`, fill=`CMV Seropositivity`),
alpha = .5,
side = "l",
outlier.shape = NA,
center = FALSE,
errorbar.draw = FALSE,
width = .4,
position = position_nudge(-0.13),
)+
theme_classic()+
scale_fill_manual(values=c("#D55E00","#56B4E9"))+
scale_color_manual(values=c("#D55E00","#56B4E9"))+
stat_summary(aes(y=entropy_cor_T0T5num_med, x=`CMV Seropositivity`),size=0.2,
position = position_nudge(-0.23))+
theme(legend.position = "none")+
ylab("Immune entropy (1-r)")
df_plot <- entropy_scores_plot %>%
drop_na(cluster_number)
n4 <- ggplot(df_plot, aes(x=cluster_number, y=entropy_cor_T0T5num_med)) +
geom_boxplot(aes(fill=cluster_number), alpha=0.9,outlier.size=0,outlier.colour="white") +
geom_jitter(aes(fill=cluster_number), alpha=0.4, width = 0.3, shape=21,size=1) +
scale_fill_manual("Immunotypes", values=cols_cluster) +
theme_classic()+xlab("Immunotypes")+
stat_summary(aes(y=entropy_cor_T0T5num_med, x=cluster_number),size=0.2)+
theme(legend.position = "none")+
ylab("Immune entropy (1-r)")
wilcox.test(entropy_scores_plot$entropy_cor_T0T5num_med ~ entropy_scores_plot$sex)
wilcox.test(entropy_scores_plot$entropy_cor_T0T5num_med ~ entropy_scores_plot$`CMV Seropositivity`)
n5 <- ggplot(entropy_scores_plot)+
geom_point(
aes(x = ResponseGroup_Triple,y = entropy_cor_T0T5num_med, group = ResponseGroup_Triple, color=ResponseGroup_Triple),
position = position_jitter(width = 0.1,seed =42),
size = 1.5,
alpha = .2,
show.legend = FALSE
)+
geom_half_violin(
aes(x = ResponseGroup_Triple,y = entropy_cor_T0T5num_med, group = ResponseGroup_Triple, fill=ResponseGroup_Triple),
alpha = .5,
side = "r",
position = position_nudge(0.13),
)+
geom_half_boxplot(
aes(x = ResponseGroup_Triple,y = entropy_cor_T0T5num_med, group = ResponseGroup_Triple, fill=ResponseGroup_Triple),
alpha = .5,
side = "l",
outlier.shape = NA,
center = FALSE,
errorbar.draw = FALSE,
width = .4,
position = position_nudge(-0.13),
)+
theme_classic()+
stat_summary(aes(y=entropy_cor_T0T5num_med, x=ResponseGroup_Triple),size=0.2,
position = position_nudge(-0.23))+
theme(legend.position = "none")+
scale_fill_manual(values=c("brown1","darkgoldenrod1","deepskyblue2","blue"))+
scale_color_manual(values=c("brown1","darkgoldenrod1","deepskyblue2","blue"))+
ylab("Immune entropy (1-r)")+
xlab("Triple vaccine response group")
ggarrange(n1,n5,n4, nrow=1)
ggsave(file = paste0(models.dir, "SFig2.pdf", sep=""), width =9 , height =3)
model_cimm <-trivac_imm %>%
left_join(entropy_scores) %>%
drop_na(cluster_number,ResponseGroup_Triple) %>%
rename(`Immunotype `=cluster_number)%>%
rename(Age=age)%>%
rename(`Immune entropy`=entropy_cor_T0T5num_med)%>%
rename(Sex=sex)%>%
rename(CMV=MIA_CMV_Seropositivity)%>%
filter(CMV %!in% 3) %>%
mutate(quartile_influ_d0_immR = recode(quartile_influ_d0_immR,
"5" = "Q1",
"[10, 28)" = "Q2",
"[28, 57)" = "Q3",
"[57,320]" = "Q4")) %>%
mutate(Sex = recode(Sex,
"1" = ": male",
"2" = ": female")) %>%
mutate(CMV = recode(CMV,
"1" = ": positive",
"2" = ": negative")) %>%
droplevels()
model_cimm$Sex <- factor(model_cimm$Sex, levels = c(": female",": male"))
model_cimm$CMV <- factor(model_cimm$CMV, levels = c(": negative",": positive"))
# contrasts(model_cimm$`day 0 HI`) = contr.sum(4)
contrasts(model_cimm$`Immunotype `) = contr.sum(9)
contrasts(model_cimm$quartile_influ_d0_immR) = contr.sum(4)
model_cimm$`Immune entropy`<-log10(model_cimm$`Immune entropy`)
logit_model <- clm(ResponseGroup_Triple_Pneu ~ `Immunotype `+Sex+Age+CMV + quartile_influ_d0_immR, data = model_cimm)
summary(logit_model)
logit_model <- clm(ResponseGroup_Triple_Pneu ~ `Immunotype `+Sex+Age+CMV , data = model_cimm)
summary(logit_model)
logit_model <- clm(ResponseGroup_Triple_Pneu ~ `Immune entropy`+Sex+Age+CMV , data = model_cimm)
summary(logit_model)
logit_model <- clm(ResponseGroup_Triple_Pneu ~ `Immune entropy`+Sex+Age+CMV , data = model_cimm)
summary(logit_model)
model_cimm <-trivac_imm %>%
left_join(entropy_scores) %>%
drop_na(cluster_number,ResponseGroup_Triple) %>%
rename(`Immunotype `=cluster_number)%>%
rename(Age=age)%>%
rename(`Immune entropy`=entropy_cor_T0T5num_med)%>%
rename(Sex=sex)%>%
rename(CMV=MIA_CMV_Seropositivity)%>%
filter(CMV %!in% 3) %>%
mutate(quartile_influ_d0_immR = recode(quartile_influ_d0_immR,
"5" = "Q1",
"[10, 28)" = "Q2",
"[28, 57)" = "Q3",
"[57,320]" = "Q4")) %>%
mutate(Sex = recode(Sex,
"1" = ": male",
"2" = ": female")) %>%
mutate(CMV = recode(CMV,
"1" = ": positive",
"2" = ": negative")) %>%
droplevels()
model_cimm$Sex <- factor(model_cimm$Sex, levels = c(": female",": male"))
model_cimm$CMV <- factor(model_cimm$CMV, levels = c(": negative",": positive"))
# contrasts(model_cimm$`day 0 HI`) = contr.sum(4)
contrasts(model_cimm$`Immunotype `) = contr.sum(9)
contrasts(model_cimm$quartile_influ_d0_immR) = contr.sum(4)
# model_cimm$`Immune entropy`<-log10(model_cimm$`Immune entropy`)
logit_model <- clm(ResponseGroup_Triple_Pneu ~ `Immunotype `+Sex+Age+CMV , data = model_cimm)
summary(logit_model)
logit_model <- clm(ResponseGroup_Triple_Pneu ~ `Immune entropy`+Sex+Age+CMV , data = model_cimm)
summary(logit_model)
logit_model <- clm(ResponseGroup_Triple_Pneu ~ `Immune entropy`+Sex+Age+CMV , data = model_cimm)
summary(logit_model)
logit_model <- clm(ResponseGroup_Triple_Pneu ~ `Immune entropy` , data = model_cimm)
summary(logit_model)
logit_model <- clm(ResponseGroup_Triple_Flu ~ `Immune entropy` , data = model_cimm)
logit_model <- clm(ResponseGroup_Triple_Flu ~ `Immune entropy` , data = model_cimm)
summary(logit_model)
logit_model <- clm(ResponseGroup_Triple_Flu ~ `Immune entropy` +quartile_influ_d0_immR, data = model_cimm)
summary(logit_model)
model_cimm
model_cimm <-trivac_imm %>%
left_join(entropy_scores) %>%
drop_na(cluster_number,ResponseGroup_Triple) %>%
rename(`Immunotype `=cluster_number)%>%
rename(Age=age)%>%
rename(`Immune entropy`=entropy_cor_T0T5num_med)%>%
rename(Sex=sex)%>%
rename(CMV=MIA_CMV_Seropositivity)%>%
filter(CMV %!in% 3) %>%
mutate(quartile_influ_d0_immR = recode(quartile_influ_d0_immR,
"5" = "Q1",
"[10, 28)" = "Q2",
"[28, 57)" = "Q3",
"[57,320]" = "Q4")) %>%
mutate(Sex = recode(Sex,
"1" = ": male",
"2" = ": female")) %>%
mutate(CMV = recode(CMV,
"1" = ": positive",
"2" = ": negative")) %>%
droplevels()
model_cimm$Sex <- factor(model_cimm$Sex, levels = c(": female",": male"))
model_cimm$CMV <- factor(model_cimm$CMV, levels = c(": negative",": positive"))
# contrasts(model_cimm$`day 0 HI`) = contr.sum(4)
contrasts(model_cimm$`Immunotype `) = contr.sum(9)
contrasts(model_cimm$quartile_influ_d0_immR) = contr.sum(4)
model_cimm$`Immune entropy`<-log10(model_cimm$`Immune entropy`)
logit_model <- clm(ResponseGroup_Triple_Pneu ~ `Immunotype `+Sex+Age+CMV , data = model_cimm)
summary(logit_model)
logit_model <- clm(ResponseGroup_Triple_Pneu ~ `Immune entropy`+Sex+Age+CMV , data = model_cimm)
summary(logit_model)
logit_model <- clm(ResponseGroup_Triple_Pneu ~ `Immune entropy` , data = model_cimm)
summary(logit_model)
logit_model <- clm(ResponseGroup_Triple_Flu ~ `Immune entropy` +quartile_influ_d0_immR, data = model_cimm)
summary(logit_model)
lm(log(influ_d28) ~ immune_entropy+quartile_influ_d0_immR, data=test) %>% summary()
lm(log(influ_d28) ~ immune_entropy+quartile_influ_d0_immR, data=model_cimm) %>% summary()
lm(log(influ_d28) ~ `Immune entropy`+quartile_influ_d0_immR, data=model_cimm) %>% summary()
